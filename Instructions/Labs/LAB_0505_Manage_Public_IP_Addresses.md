---
lab:
  title: ラボ:Azure Stack Hub でパブリック IP アドレスを管理する
  module: 'Module 5: Manage Infrastructure'
ms.openlocfilehash: 8cbf28dee995b412e3bad372316b989bc30be202
ms.sourcegitcommit: ded7cfa9cd6281bd9b56d2d7496746921dc82b73
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/29/2022
ms.locfileid: "146735786"
---
# <a name="lab---manage-public-ip-addresses-in-azure-stack-hub"></a>ラボ - Azure Stack Hub でパブリック IP アドレスを管理する
# <a name="student-lab-manual"></a>受講生用ラボ マニュアル

## <a name="lab-dependencies"></a>ラボの依存関係

- なし

## <a name="estimated-time"></a>推定所要時間

30 分

## <a name="lab-scenario"></a>ラボのシナリオ

あなたは Azure Stack Hub 環境のオペレーターとして、 パブリック IP アドレス リソースを管理する必要があります。 

## <a name="objectives"></a>目標

このラボを完了すると、次のことができるようになります。

- パブリック IP アドレス リソースを管理する

## <a name="lab-environment"></a>ラボ環境

このラボでは、Active Directory フェデレーション サービス (AD FS) (ID プロバイダーとしてバックアップされた Active Directory) に統合された ADSK インスタンスを使用します。 

ラボ環境は、次のコンポーネントから構成されています。

- 次のアクセス ポイントを持つ、**AzS-HOST1** サーバーで実行されている ASDK デプロイ。

  - 管理者ポータル: https://adminportal.local.azurestack.external
  - 管理者の ARM エンドポイント: https://adminmanagement.local.azurestack.external
  - ユーザー ポータル: https://portal.local.azurestack.external
  - ユーザーの ARM エンドポイント: https://management.local.azurestack.external

- 管理ユーザー:

  - ASDK クラウド オペレーターのユーザー名: **CloudAdmin@azurestack.local**
  - ASDK クラウド オペレーターのパスワード:**Pa55w.rd1234**
  - ASDK ホスト管理者のユーザー名: **AzureStackAdmin@azurestack.local**
  - ASDK ホスト管理者のパスワード:**Pa55w.rd1234**

このラボでは、PowerShell を介して Azure Stack Hub を管理するために必要なソフトウェアをインストールします。 追加のユーザー アカウントも作成します。

## <a name="instructions"></a>Instructions

### <a name="exercise-1-create-an-offer-as-a-cloud-operator"></a>演習 1:(クラウド オペレーターとして) オファーを作成する

この演習では、クラウド オペレーターの役を担います。 最初に、パブリック IP アドレスの使用状況を確認してから、ネットワーク サービスが含まれるプランを作成した後、このプランが含まれるオファーを作成します。 続いて、オファーをパブリックに設定することで、ユーザーがこのオファーに基づいてサブスクリプションを作成できるようにします。 演習は次のタスクで構成されています。

1. (クラウド オペレーターとして) パブリック IP アドレスの使用状況を確認する
1. (クラウド オペレーターとして) ネットワーク サービスから構成されるプランを作成する
1. (クラウド オペレーターとして) プランに基づいたオファーを作成し、このオファーをパブリックに設定する


#### <a name="task-1-review-public-ip-address-usage-as-a-cloud-operator"></a>タスク 1:(クラウド オペレーターとして) パブリック IP アドレスの使用状況を確認する

このタスクでは次のことを行います。

- (クラウド オペレーターとして) パブリック IP アドレスの使用状況を確認する

1. **AzS-HOST1** へのリモート デスクトップ セッション内で、Web ブラウザー ウィンドウを開いて [Azure Stack Hub 管理者ポータル](https://adminportal.local.azurestack.external/)を表示し、CloudAdmin@azurestack.local としてサインインします。
1. Azure Stack Hub 管理者ポータルの **[ダッシュボード]** ページで、**[リソース プロバイダー]** タイルの **[ネットワーク]** をクリックします。 
1. **[ネットワーク]** ブレードで、**[パブリック IP プールの使用量]** グラフと、使用中および未使用の IP アドレスの数を確認します。

#### <a name="task-2-create-a-plan-consisting-of-the-network-services-as-a-cloud-operator"></a>タスク 2:(クラウド オペレーターとして) ネットワーク サービスから構成されるプランを作成する

このタスクでは次のことを行います。

- (クラウド オペレーターとして) ネットワーク サービスから構成されるプランを作成する

1. Web ブラウザーの画面に Azure Stack Hub 管理者ポータルが表示されている状態で、**[+ リソースの作成]** をクリックします。 
1. **[新規]** ブレードで **[オファーとプラン]** をクリックします。
1. **[オファーとプラン]** ブレードで **[プラン]** をクリックします。
1. **[新しいプラン]** ブレードの **[基本]** タブで、次のように設定を行います。

    - 表示名:**Network-plan1**
    - リソース名: **network-plan1**
    - リソース グループ: 新しいリソース グループの名前 **network-plans-RG**

1. **[次へ: サービス >]** をクリックします。
1. **[新しいプラン]** ブレードの **[サービス]** タブで、**[Microsoft.Network]** チェックボックスをオンにします。
1. **[次へ: クォータ >]** をクリックします。
1. **[新しいプラン]** ブレードの **[クォータ]** タブで、**[新規作成]** チェックボックスをオンにします。
1. **[ネットワーク クォータの作成]** ブレードで、次のように設定してから **[OK]** をクリックします。

    - 名前: **Network-plan1-quota**
    - 仮想ネットワーク:**2**
    - 仮想ネットワーク ゲートウェイ:**2**
    - ネットワーク接続: **2**
    - パブリック IP:**20**
    - NIC:**20**
    - ロード バランサー:**5**
    - ネットワーク セキュリティ グループ:**20**

1. **[Review + create]\(レビュー + 作成\)** をクリックし、 **[作成]** をクリックします。

    >**注**: デプロイが完了するまで待ちます。 通常は数秒で完了します。


#### <a name="task-3-create-an-offer-based-on-the-plan-as-a-cloud-operator"></a>タスク 3:(クラウド オペレーターとして) プランに基づいたオファーを作成する

このタスクでは次のことを行います。

- (クラウド オペレーターとして) プランに基づいたオファーを作成する

1. Azure Stack Hub 管理者ポータルで、**[+ リソースの作成]** をクリックします。 
1. **[新規]** ブレードで **[オファーとプラン]** をクリックします。
1. **[オファーとプラン]** ブレードで **[オファー]** をクリックします。
1. **[新しいオファーの作成]** ブレードの **[基本]** タブで、次のように設定を行います。

    - 表示名:**Network-offer1**
    - リソース名: **network-offer1**
    - リソース グループ: **network-offers-RG** という名前の新しいリソース グループ
    - このオファーをパブリックに設定する:**はい**

1. **[次へ: 基本プラン >]** をクリックします。 
1. **[新しいオファーの作成]** ブレードの **[基本プラン]** タブで、**[Network-plan1]** エントリの横にあるチェックボックスをオンにします。
1. **[次へ: アドオン プラン >]** をクリックします。
1. **[アドオン プラン]** の設定は既定値にしたまま、**[確認および作成]** をクリックしてから **[作成]** をクリックします。

    >**注**: デプロイが完了するまで待ちます。 通常は数秒で完了します。

>**レビュー**:この演習では、プランを作成し、そのプランに基づいてパブリック オファーを作成しました。


### <a name="exercise-2-create-public-ip-address-resources-as-a-user"></a>演習 2:(ユーザーとして) パブリック IP アドレス リソースを作成する

この演習ではユーザーとして、最初の演習で作成したオファーにサインアップした後、新しいサブスクリプションを作成してから、このサブスクリプションのもとでパブリック IP アドレス リソースを作成します。 演習は次のタスクで構成されています。

1. (ユーザーとして) オファーにサインアップする
1. (ユーザーとして) IP アドレス リソースを作成する

#### <a name="task-1-sign-up-for-the-offer-as-a-user"></a>タスク 1:(ユーザーとして) オファーにサインアップする

このタスクでは次のことを行います。

- (ユーザーとして) オファーにサインアップする

1. 1. **AzS-HOST1** へのリモート デスクトップ セッション内で、Web ブラウザーの InPrivate セッションを開始します。
1. Web ブラウザー ウィンドウで [Azure Stack Hub ユーザー ポータル](https://portal.local.azurestack.external)に移動し、 **t1u1@azurestack.local** とパスワード **Pa55w.rd** でサインインします。
1. Azure Stack Hub ユーザー ポータルのダッシュボードで、**[サブスクリプションの取得]** をクリックします。
1. **[サブスクリプションの取得]** ブレードの **[名前]** テキスト ボックスに、「**T1U1-network-subscription1**」と入力します。
1. オファーの一覧で、**[Network-offer1]** を選択し、**[作成]** をクリックします。
1. メッセージ ボックス "**サブスクリプションが作成されました。サブスクリプションの使用を開始するには、ポータルを更新する必要があります**" で、 **[最新の情報に更新]** をクリックします。

#### <a name="task-2-create-a-public-ip-address-as-a-user"></a>タスク 2:(ユーザーとして) パブリック IP アドレスを作成する

このタスクでは次のことを行います。

- (ユーザーとして) Azure Stack Hub ユーザー ポータル を使用してパブリック IP アドレスを作成する

1. Azure Stack Hub ユーザー ポータルのダッシュボードで、 **[+ リソースの作成]** をクリックします。
1. **[Marketplace]** ブレードで **[パブリック IP アドレス]** を選択し、 **[パブリック IP アドレス]** ブレードで **[作成]** を選択します。
1. **[パブリック IP アドレスの作成]** ブレードで、次の設定を指定し、 **[作成]** を選択します (その他はすべて既定値のままにします)。

    - 名前: **t1-pip1**
    - IP アドレスの割り当て:**動的**
    - アイドル タイムアウト (分):**4**
    - DNS 名ラベル: **t1-pip1**
    - [サブスクリプション]:**T1U1-network-subscription1**
    - リソース グループ: **publicIPs-RG** という名前の新規リソース グループ
    - 場所: **ローカル**

1. IP アドレス リソースがプロビジョニングされるまで待ちます。

>**レビュー**:この演習では、ユーザーのサブスクリプションのもとでパブリック IP アドレス リソースを作成しました。

### <a name="exercise-3-manage-public-ip-address-usage-as-a-cloud-operator"></a>演習 3:(クラウド オペレーターとして) パブリック IP アドレスの使用状況を管理する

この演習ではクラウド オペレーターとして、パブリック IP アドレスの使用状況を確認および管理します。 演習は次のタスクで構成されています。

1. パブリック IP アドレス リソースの使用状況を確認する
2. パブリック IP アドレス プールを追加する

#### <a name="task-1-review-public-ip-address-usage-as-a-cloud-operator"></a>タスク 1:(クラウド オペレーターとして) パブリック IP アドレスの使用状況を確認する

このタスクでは次のことを行います。

- (クラウド オペレーターとして) パブリック IP アドレスの使用状況を確認する

1. Azure Stack Hub 管理者ポータルが表示されている Web ブラウザー ウィンドウに切り替えます (ここでは CloudAdmin@azurestack.local としてサインインしています)。
1. Azure Stack Hub 管理者ポータルのハブ メニューで、**[ダッシュボード]** をクリックし、**[リソース プロバイダー]** タイルの **[ネットワーク]** をクリックします。
1. **[ネットワーク]** ブレードで、**[パブリック IP プールの使用量]** グラフと、使用中および未使用の IP アドレスの数を再度確認します。

    >**注**:ユーザー サブスクリプションのもとで (ユーザーとして) 追加のパブリック IP アドレスを作成したことで、数が変化しているはずです。

#### <a name="task-2-add-a-public-ip-address-pool-as-a-cloud-operator"></a>タスク 2:(クラウド オペレーターとして) パブリック IP アドレス プールを追加する

このタスクでは次のことを行います。

- パブリック IP アドレス プールを追加する

1. Web ブラウザーの画面に Azure Stack Hub 管理者ポータルが表示されている状態で、**[ネットワーク]** ブレードの **[パブリック IP プールの使用量]** タイルを選択します。

    >**注**: **[パブリック IP プール]** ブレードに " **'スタートアップ' の排他的操作が進行中です。この操作の実行中は、ノードを追加する操作や IP プールを追加する操作は実行できません。ここをクリックしてアクティビティ ログを確認してください**" のメッセージが表示された場合は、'スタートアップ' 操作が完了するまで次の手順に進むことはできません。

1. **[パブリック IP プール]** ブレードで、**[+ IP プールの追加]** をクリックします。 
1. **[IP プールの追加]** ブレードで、次のように設定してから **[追加]** をクリックします。

    - 名前: **Public Pool 1**
    - リージョン: **ローカル**
    - アドレス範囲 (CIDR ブロック):**192.168.110.0/24**

1. 変更が適用されるまで待ってから、**[ネットワーク]** ブレードに戻ります。
1. **[パブリック IP プールの使用量]** グラフで、未使用の IP アドレスの数の変化を確認します。

>**レビュー**:この演習では、パブリック IP アドレス プールを確認して構成しました。
